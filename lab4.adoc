:diagram-use-plantuml:
:author: Залипаева Эвелина КЭ-201
:icon: front
:secttrue: true
:toc: left
:toclevels: 2
:secttruelevels: 2
:sectnums: |,all|
:stylesheet: custom.css
:stylesdir: ./styles
:imagesdir: pic
:toc:
:toc-title: Оглавление
:figure-caption: Рисунок
:table-caption: Таблица

include::test.adoc[]

== Введение в FreeRTOS
FreeRTOS — операционная система реального времени, предоставляющая инструменты для:

* Создания и управления задачами.
* Синхронизации и коммуникации между задачами.
* Работы с таймерами и прерываниями.

== Работа с задачами

=== Создание задач
Используется RtosWrapper (обертка для конкретной RTOS) должен вызывать приватный метод Run для старта потока. Пример:
[source,c]
----
friend class RtosWrapper;    

  private:
    //cstat !MISRAC++2008-7-1-2 To prevent reinterpret_cast in the CreateTask
    __forceinline static void Run(void *pContext)
    {
      static_cast<IThread*>(pContext)->Run();
    }
----

=== Управление задержками
В реализации RtosWrapper::wHandleSysTickInterrupt может вестись подсчёт тиков, что позволяет реализовать:

* Функции задержки (vTaskDelay в FreeRTOS).

* Учёт времени выполнения потоков.

* Таймеры ОС
----
__forceinline static void HandleSysTickInterrupt() {
  RtosWrapper::wHandleSysTickInterrupt();
}
----

== Межзадачная коммуникация

=== Очереди
Очереди — базовый механизм для передачи данных и синхронизации.  

=== Нотификации задач
Нотификации — легковесная альтернатива очередям. Используется функция `taskNotify`.

==== Параметры `taskNotify`:
[cols="1,3", options="header"]
|===
| Параметр | Описание
| `taskToNotify` | Дескриптор задачи-получателя
| `value` | Передаваемое значение (32 бита)
| `eAction` | Действие над значением получателя
|===

==== Типы действий (`eAction`):
* `eNoAction`: Значение игнорируется (используется для пробуждения задачи).
* `eSetBits`: Установка битов в переменной-уведомлении получателя.
* `eSetValueWithOverwrite`: Перезапись текущего значения.
* `eSetValueWithoutOverwrite`: Запись только если предыдущее значение обработано.


== Сравнение механизмов
[cols="1,1,1", options="header"]
|===
| Механизм | Преимущества | Недостатки
| *Очереди* | Поддержка сложных данных | Высокие накладные расходы
| *Нотификации* | Быстродействие | Ограничение 32 битами
| *События* | Гибкость | Требуют ручного управления битами
|===

== Выводы
* Освоено создание задач через `oRTOS.createTask` и управление их выполнением.
* Изучены нотификации как эффективный механизм для передачи флагов и значений.
* Применены различные действия (`eSetBits`, `eSetValueWithOverwrite`) в `taskNotify`.
* Сравнены механизмы коммуникации: очереди подходят для данных, нотификации — для легковесных событий.
